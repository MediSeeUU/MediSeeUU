<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MediSee: Code expansion guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MediSee<span id="projectnumber">&#160;1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_medctrl_frontend_code_expansion_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Code expansion guide </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md38"></a>
General</h1>
<p >We have tried to make the dashboard as dynamic as possible by making it depend on the backend, meaning we do not have many hardcoded components. Therefore, for tasks like adding a new variable, we refer to the backend guide. If a new variable is added on the backend, then the frontend instantly supports this new variable.</p>
<p >If you want to write unit tests that use new variables, the only things you need to do is replace the <code>structServer</code> json file, which is located in the <code>src\json</code> folder, with the new structure data retrieved from the respective endpoint of the backend. This file essentially translates the backend key to a frontend version and includes some information like the data type. The same must be done for the <code>allServerData</code> json file, which is located in the same directory, but then should be replaced with the updated medicines data retrieved from the respective endpoint again of the backend. All files in this directory are used to mock the backend server which allows to unit test certain components that normally need these data from the server.</p>
<h1><a class="anchor" id="autotoc_md39"></a>
Text</h1>
<p >Text on e.g. the information and home page can easily be changed as well. They are all located in their respective page files, e.g. <code>HomePage</code> in <code>src\pages\home</code>. The text in the header is located in the <code>src\core\header</code> directory in the <code>Header</code> file. Analogously, the text in the footer is located in the <code>src\core\footer</code> directory in the <code>Footer</code> file.</p>
<h1><a class="anchor" id="autotoc_md40"></a>
Visualizations</h1>
<p >There are a variety of visualization types, each having its own options or properties in their display. To keep the visualizations modular and therefore extensible, a visualization is built of 3 individual components: visualization_type, data_interface and form. These are all located in the <code>src\pages\visualizations\single_visualization</code> directory. We will discuss each of them more in-depth.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
visualization_types</h2>
<p >The <code>visualization_types</code> directory contains a separate file for each chart. This file holds a function-based component which initializes the settings of the chart and renders the chart. To add a new chart, a new file must be created in this directory. The structure of such a file is as follows:</p>
<div class="fragment"><div class="line">import React from &#39;react&#39;</div>
<div class="line">import Chart from &#39;react-apexcharts&#39;</div>
<div class="line"> </div>
<div class="line">// Replace &quot;SomeChart&quot; with the name of your chart component, e.g. &quot;BarChart&quot;</div>
<div class="line">function SomeChart(props) {</div>
<div class="line">  let settings = {</div>
<div class="line">    options: {</div>
<div class="line">      // Some chart specific options here</div>
<div class="line">    }</div>
<div class="line">    // Add the series to the settings</div>
<div class="line">    // The series is passed as a property to the component</div>
<div class="line">    series: props.series,</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  return (</div>
<div class="line">    // Replace &quot;charttype&quot; with the type of the chart, e.g. &quot;bar&quot;</div>
<div class="line">    &lt;div className=&quot;med-vis-chart&quot;&gt;</div>
<div class="line">      &lt;Chart</div>
<div class="line">        options={settings.options}</div>
<div class="line">        series={settings.series}</div>
<div class="line">        type=&quot;charttype&quot;</div>
<div class="line">        height={700}</div>
<div class="line">      /&gt;</div>
<div class="line">    &lt;/div&gt;</div>
<div class="line">  )</div>
<div class="line">}</div>
</div><!-- fragment --><p >The series, stored in the settings variable, is the data that will be displayed in the chart. This is constructed with the data_interface corresponding to the specific chart. More on that later. For information on which specific options are available for each chart type, visit <a href="https://apexcharts.com/docs">the documentation of ApexCharts</a>.</p>
<h2><a class="anchor" id="autotoc_md42"></a>
data_interfaces</h2>
<p >We can not blindly pass the medicines data retrieved from the API to display the data in the chart. Some sort of processing of this data must be done beforehand. This is where the data_interface comes into play.</p>
<p >The <code>data_interfaces</code> directory contains a separate file for each chart type. This file holds a JavaScript function that calculates the series for the specific chart. The parameter <code>settings</code> passed to this function must contain the settings specified by the user in the form and the complete medicines data.</p>
<p >The directory furthermore contains the directories <code>shared_one_dimension</code> and <code>shared_two_dimensions</code>. These directories contain files again with functions that help calculating the series. The functions of <code>shared_one_dimension</code> are used by any chart with only one dimension (e.g. pie and histogram), while the functions of <code>shared_two_dimensions</code> are used by any chart with two dimensions (e.g. bar and line).</p>
<p >The <code>shared_one_dimension</code> directory only contains the file <code>pollChosenVariable</code>. This file holds a function with the same name. Based on the passed data, the chosen x-axis (the variable chosen to display) and the chosen categories (values of the variable), it calculates the frequency for each chosen category in the data (e.g. Decision Year 1995 has a frequency of 3). The function returns an array with a dictionary <code>dict</code> that maps categories to frequencies and another dictionary <code>euNumbers</code> that maps categories to the eu numbers that contributed to the frequency. The <code>dict</code> dictionary is essentially the calculated series. The <code>euNumbers</code> dictionary is additionally returned to identify the data points again. If a user clicks on a specific area of the chart, we can filter the data on these numbers and display this in a separate table. An example of the content those dictionaries:</p>
<div class="fragment"><div class="line">// Variable: Decision Year</div>
<div class="line">// Chosen categories: 1995</div>
<div class="line"> </div>
<div class="line">// Maps categories to frequencies</div>
<div class="line">dict = {</div>
<div class="line">  1995: 3,</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Maps categories to their eu numbers</div>
<div class="line">// So the data with eu numbers 1, 2 and 3 have Decision Year 1995</div>
<div class="line">euNumbers = {</div>
<div class="line">  1995: [1, 2, 3],</div>
<div class="line">}</div>
</div><!-- fragment --><p >The <code>shared_two_dimensions</code> directory contains multiple files. To calculate the series, first the <code>pollChosenVariable</code> function is used. It is very similar to the one in the <code>shared_one_dimension</code>, however, a chosen y-axis and the chosen categories on the y-axis must be passed this time as well. It calculates the frequency again of the chosen categories on the x-axis, but it also makes a distinction between the chosen categories on the y-axis now. An example of those dictionaries:</p>
<div class="fragment"><div class="line">// X-axis: Decision Year</div>
<div class="line">// Y-axis: Rapporteur</div>
<div class="line">// Chosen categories x-axis: 1995</div>
<div class="line">// Chosen categories y-axis: United Kingdom and France</div>
<div class="line"> </div>
<div class="line">dict = {</div>
<div class="line">  1995: {</div>
<div class="line">    &#39;United Kingdom&#39;: 2,</div>
<div class="line">    France: 1,</div>
<div class="line">  },</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">euNumbers = {</div>
<div class="line">  1995: {</div>
<div class="line">    &#39;United Kingdom&#39;: [1, 3],</div>
<div class="line">    France: [2],</div>
<div class="line">  },</div>
<div class="line">}</div>
</div><!-- fragment --><p >However, this format is not the expected format of the library yet. It expects a dictionary that maps each category chosen on the y-axis to an array of frequencies, with each frequency element corresponding to a chosen category on the x-axis. This will be translated by the <code>createSelectedSeries</code> function into a format like this:</p>
<div class="fragment"><div class="line">// X-axis: Decision Year</div>
<div class="line">// Y-axis: Rapporteur</div>
<div class="line">// Chosen categories x-axis: 2004, 2005 and 2006</div>
<div class="line">// Chosen categories y-axis: Belgium and Ireland</div>
<div class="line"> </div>
<div class="line">series = {</div>
<div class="line">  Belgium: [1, 3, 3],</div>
<div class="line">  Ireland: [2, 2, 2],</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">euSeries = {</div>
<div class="line">  Belgium: [[270], [299, 301, 302], [325, 330, 333]],</div>
<div class="line">  Denmark: [</div>
<div class="line">    [284, 286],</div>
<div class="line">    [306, 307],</div>
<div class="line">    [354, 361],</div>
<div class="line">  ],</div>
<div class="line">}</div>
</div><!-- fragment --><p >The <code>toSeriesFormat</code> function will then finalize the format by putting the <code>series</code> and <code>euSeries</code> together in one output value, which can then be used to display the data in the chart.</p>
<p >To add support for a new chart, a new file must be created in the <code>data_interfaces</code> directory. Depending on the dimension of the chart, you should use the corresponding helper functions described above. The expected format of the series for a chart can be found again at <a href="https://apexcharts.com/docs">the documentation of ApexCharts</a>.</p>
<p >On top of that, a case to the switch statement in the <code>generateSeries</code> function must be added. The file is located in the <code>single_visualization\utils</code> directory. This function calls the series function which corresponds with the chart type. Add the following code to the switch:</p>
<div class="fragment"><div class="line">// Replace &quot;charttype&quot; with the type of the chart, e.g. &quot;bar&quot;</div>
<div class="line">case &#39;charttype&#39;:</div>
<div class="line">  // Replace &quot;generateChartSeries&quot; with your new function that calculates the series, e.g. &quot;generateBarSeries&quot;</div>
<div class="line">  return generateChartSeries(settings)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43"></a>
forms</h2>
<p >The <code>forms</code> directory contains the file <code>VisualizationForm</code> which is a function-based component that renders the main form of the visualizations page. The directory also contains the directories <code>types</code> and <code>shared</code>. The <code>shared</code> directory contains the <code>CategoryOptions</code> file. This file holds a function-based component rendering the category list, where categories can be selected based on the selected variable. This component is currently used in the forms of all the chart types. The <code>types</code> directory contains a separate file for each chart type. This file contains a function-based component that renders all the options on the form, e.g. "stacked" and "switch axes" for a bar chart, the dropdowns for the variables and the category options.</p>
<p >To add support for a new chart, a new file must be created in the <code>types</code> directory with similar content to the content of the other files. Based on what options this new chart has, you can build the modifiers in this new file. The options of a chart can be found again at <a href="https://apexcharts.com/docs">the documentation of ApexCharts</a>. When you have created such a new file, you should also add a new case to the switch statement in the <code>renderChartOptions</code> function in the <code>VisualizationForm</code> file:</p>
<div class="fragment"><div class="line">// Replace &quot;charttype&quot; with the name of the new chart type, e.g. &quot;bar&quot;</div>
<div class="line">case &#39;charttype&#39;:</div>
<div class="line">  return (</div>
<div class="line">    // Replace &quot;ChartForm&quot; with the name of your form component, e.g. &quot;BarForm&quot;</div>
<div class="line">    &lt;ChartForm</div>
<div class="line">      uniqueCategories={props.uniqueCategories}</div>
<div class="line">      onChange={handleChange}</div>
<div class="line">      chartSpecificOptions={settings.chartSpecificOptions}</div>
<div class="line">    /&gt;</div>
<div class="line">  )</div>
</div><!-- fragment --><p >To make the new chart visible to the "Visualization type" dropdown, you should add an option to the select element in the return statement of the same file:</p>
<div class="fragment"><div class="line">&lt;!-- Replace &quot;charttype&quot; with the same name you just provided to the case in the switch statement, e.g. &quot;bar&quot; --&gt;</div>
<div class="line">&lt;option value=&quot;charttype&quot;&gt;Your new chart type&lt;/option&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md44"></a>
Add render</h2>
<p >If you performed all the previous steps correctly, you should now be able to add the chart to the renderer. To do this, go back to the <code>single_visualization</code> directory. This contains the <code>SingleVisualization</code> file which holds a function-based component that renders the chosen visualization type and the export and remove buttons. Import the chart file you added in the <code>visualization_types</code> folder before and add a new case to the switch statement in the <code>renderChart</code> function:</p>
<div class="fragment"><div class="line">// Replace &quot;charttype&quot; with the name of the new chart type, e.g. &quot;bar&quot;</div>
<div class="line">case &#39;charttype&#39;:</div>
<div class="line">  return (</div>
<div class="line">    // Replace &quot;SomeChart&quot; with the name of your chart component, e.g. &quot;BarChart&quot;</div>
<div class="line">    &lt;SomeChart</div>
<div class="line">      legend={legendOn}</div>
<div class="line">      labels={labelsOn}</div>
<div class="line">      id={id}</div>
<div class="line">      series={series}</div>
<div class="line">      categories={categories}</div>
<div class="line">      options={options}</div>
<div class="line">      onDataClick={onDataClick}</div>
<div class="line">    /&gt;</div>
<div class="line">  )</div>
</div><!-- fragment --><p >You may also want to add an extra case to the <code>renderTitlePlaceHolder</code> function in the <code>SingleVisualization</code> file to customize the title placeholder. The dashboard should now have support for your new visualization type.</p>
<h1><a class="anchor" id="autotoc_md45"></a>
Pages</h1>
<p >Adding more pages to the dashboard is also possible. First, you should create a new directory in the <code>src\pages</code> directory with the name of your new page, e.g. <code>data</code>. In your new directory, a JavaScript file should be created with the appropriate name, e.g. <code>DataPage</code>. You can also create CSS file with the same name if you want to apply styling. The JavaScript file will hold a function-based component that renders your new page. It has the following structure:</p>
<div class="fragment"><div class="line">import React from &#39;react&#39;</div>
<div class="line"> </div>
<div class="line">// Import CSS for styling</div>
<div class="line">import &#39;./YourPage.css&#39;</div>
<div class="line"> </div>
<div class="line">function YourPage() {</div>
<div class="line">  // Some variables and/or functions here</div>
<div class="line">  return (</div>
<div class="line">    // The HTML code of your new page (with CSS references)</div>
<div class="line">  )</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">export default YourPage</div>
</div><!-- fragment --><p >Note that all pages in the dashboard are constructed this way. So making changes to the content of existing pages should be straightforward.</p>
<p >Then navigate to the <code>src\core</code> directory. This directory contains the <code>Routing</code> file holding a function-based component that provides the dashboard with routing information. To add your new page to the routing, add the following line between the <code>Routes</code> element in the return statement of the function:</p>
<div class="fragment"><div class="line">// Replace &quot;/PATH&quot; with your desired path</div>
<div class="line">// Replace &quot;YourPage&quot; with the name of the page component</div>
<div class="line">&lt;Route path=&quot;/PATH&quot; element={&lt;YourPage /&gt;} /&gt;</div>
</div><!-- fragment --><p >If you now enter your path in the url of the application, your new page should appear. However, the navigation bar does not show this new page yet. Navigate to the <code>src\core\navigation</code> directory. This directory contains the file <code>Navigation</code> which renders the navigation bar and its components. To add your new page to the navigation bar, add the following component between the other similar components in the return statement:</p>
<div class="fragment"><div class="line">// Replace &quot;NAME OF YOUR PAGE&quot; with the name of your new page, e.g. &quot;Data&quot;</div>
<div class="line">// Replace &quot;CLASSNAME OF ICON&quot; with the classname of a icon that suits your page; see boxicons.com</div>
<div class="line">// Replace &quot;/PATH&quot; with your earlier specified path</div>
<div class="line"> </div>
<div class="line">&lt;NavLink</div>
<div class="line">  name=&quot;NAME OF YOUR PAGE&quot;</div>
<div class="line">  image=&quot;CLASSNAME OF ICON&quot;</div>
<div class="line">  dest=&quot;/PATH&quot;</div>
<div class="line">  parent={this}</div>
<div class="line">/&gt;</div>
</div><!-- fragment --><p >Now the dashboard fully supports this new page.</p>
<h1><a class="anchor" id="autotoc_md46"></a>
Contexts</h1>
<p >The application uses contexts to provide components with data. Data is regularly passed as properties in a component, but in some cases, the same data is used in multiple (non-related) components which makes it inconvenient to pass them constantly as properties to each other. It also allows to keep the state consistent while navigating to different pages.</p>
<p >To add a context, first navigate to the <code>src\shared\contexts</code> directory. This directory contains all the separate contexts of the application. Create a new file in this directory (which also ends with Context). The structure of this file is as follows:</p>
<div class="fragment"><div class="line">import React from &#39;react&#39;</div>
<div class="line"> </div>
<div class="line">// Replace &quot;YourContext&quot; with the name of your context, e.g. &quot;DataContext&quot;</div>
<div class="line">const YourContext = React.createContext()</div>
<div class="line"> </div>
<div class="line">// Replace &quot;useYour&quot; with something that corresponds to the name, e.g. &quot;useData&quot;</div>
<div class="line">export function useYour() {</div>
<div class="line">  // Replace &quot;YourContext&quot; with the name of your context specified in the constant</div>
<div class="line">  return useContext(YourContext)</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Replace &quot;YourProvider&quot; with the name of your context, e.g. &quot;DataProvider&quot;</div>
<div class="line">export function YourProvider({ children }) {</div>
<div class="line">  // Some variables and/or functions here</div>
<div class="line">  return (</div>
<div class="line">    // Replace &quot;YourContext&quot; with the name of your context specified in the constant</div>
<div class="line">    // Replace &quot;InsertDataHere&quot; with the variable that contains the data you want to pass</div>
<div class="line">    &lt;YourContext.Provider value={InsertDataHere}&gt;</div>
<div class="line">      {children}</div>
<div class="line">    &lt;/YourContext.Provider&gt;</div>
<div class="line">  )</div>
<div class="line">}</div>
</div><!-- fragment --><p >What remains is adding this individual provider to the chain of providers. Navigate to the <code>src\shared</code> directory. This directory contains a <code>Provider</code> file which represents the chain of providers. You can add your provider somewhere between those other providers. It does not matter where you put it in general, but if you need data from one of other providers in your context, then you should put your provider as a child of this provider.</p>
<p >Now you can get this data anywhere in the application if you call the following statement:</p>
<div class="fragment"><div class="line">// Replace &quot;useYour&quot; with the same name of the function of your context specified earlier</div>
<div class="line">const data = useYour()</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
