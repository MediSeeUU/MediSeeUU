

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>web_scraper package &mdash; Web Scraper 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="web_scraper" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../../../docs/html/README.html">
  <img src="_static/medisee.svg" class="logo" alt="Logo"/>
</a>


  
  



        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
      <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
      <ul>
        <li class="toctree-l1 current-module"><a href="../../../../scraping/web_scraper/docs/html/index.html">Web Scraper</a></li>
        <li class="toctree-l1 "><a href="../../../../scraping/filter/docs/html/index.html">Filter</a></li>
        <li class="toctree-l1 "><a href="../../../../scraping/pdf_parser/docs/html/index.html">File Parser</a></li>
        <li class="toctree-l1 "><a href="../../../../scraping/combiner/docs/html/index.html">Combiner</a></li>
        <li class="toctree-l1 "><a href="../../../../scraping/db_communicator/docs/html/index.html">DB Communicator</a></li>
        <li class="toctree-l1 "><a href="../../../../backend/API/docs/html/index.html">Backend</a></li>
        <li class="toctree-l1 margin-top "><a href="../../../../tests/docs/html/index.html">Tests</a></li>
      </ul>
    </div>
    
      
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Readme</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Web Scraper</a><ul>
<li class="toctree-l2"><a class="reference internal" href="README.html#general-function">General Function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="README.html#ec-scraper-py">ec_scraper.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="README.html#ema-scraper-py">ema_scraper.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="README.html#download-py">download.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="README.html#filter-retry-py">filter_retry.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="README.html#main-py"><strong>main</strong>.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="README.html#input-output">Input &amp; Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#other-important-notes">Other important notes</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Source Code Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">web_scraper</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">web_scraper package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-web_scraper.__main__">web_scraper.__main__ module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.__main__.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-web_scraper.download">web_scraper.download module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.download.download_all"><code class="docutils literal notranslate"><span class="pre">download_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.download.download_medicine_files"><code class="docutils literal notranslate"><span class="pre">download_medicine_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.download.download_pdfs_ec"><code class="docutils literal notranslate"><span class="pre">download_pdfs_ec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.download.download_pdfs_ema"><code class="docutils literal notranslate"><span class="pre">download_pdfs_ema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.download.get_date_from_url"><code class="docutils literal notranslate"><span class="pre">get_date_from_url()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.download.save_new_eu_numbers"><code class="docutils literal notranslate"><span class="pre">save_new_eu_numbers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-web_scraper.ec_scraper">web_scraper.ec_scraper module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.add_to_non_english_file"><code class="docutils literal notranslate"><span class="pre">add_to_non_english_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.determine_current_aut_type"><code class="docutils literal notranslate"><span class="pre">determine_current_aut_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.determine_ema_number"><code class="docutils literal notranslate"><span class="pre">determine_ema_number()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.determine_initial_aut_type"><code class="docutils literal notranslate"><span class="pre">determine_initial_aut_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.format_ema_number"><code class="docutils literal notranslate"><span class="pre">format_ema_number()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.get_data_from_medicine_json"><code class="docutils literal notranslate"><span class="pre">get_data_from_medicine_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.get_data_from_procedures_json"><code class="docutils literal notranslate"><span class="pre">get_data_from_procedures_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.get_ec_html"><code class="docutils literal notranslate"><span class="pre">get_ec_html()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.get_ec_json_objects"><code class="docutils literal notranslate"><span class="pre">get_ec_json_objects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.get_last_updated_date"><code class="docutils literal notranslate"><span class="pre">get_last_updated_date()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.scrape_active_withdrawn_jsons"><code class="docutils literal notranslate"><span class="pre">scrape_active_withdrawn_jsons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.scrape_ec"><code class="docutils literal notranslate"><span class="pre">scrape_ec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.scrape_medicine_page"><code class="docutils literal notranslate"><span class="pre">scrape_medicine_page()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.scrape_medicines_list"><code class="docutils literal notranslate"><span class="pre">scrape_medicines_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.scrape_refused_jsons"><code class="docutils literal notranslate"><span class="pre">scrape_refused_jsons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.set_human_attributes"><code class="docutils literal notranslate"><span class="pre">set_human_attributes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ec_scraper.set_orphan_attributes"><code class="docutils literal notranslate"><span class="pre">set_orphan_attributes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-web_scraper.ema_scraper">web_scraper.ema_scraper module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ema_scraper.create_url_list"><code class="docutils literal notranslate"><span class="pre">create_url_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ema_scraper.find_last_updated_date"><code class="docutils literal notranslate"><span class="pre">find_last_updated_date()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ema_scraper.find_last_updated_date_annex10"><code class="docutils literal notranslate"><span class="pre">find_last_updated_date_annex10()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ema_scraper.find_priority_link"><code class="docutils literal notranslate"><span class="pre">find_priority_link()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ema_scraper.get_url_type"><code class="docutils literal notranslate"><span class="pre">get_url_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ema_scraper.scrape_ema"><code class="docutils literal notranslate"><span class="pre">scrape_ema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.ema_scraper.scrape_medicine_page"><code class="docutils literal notranslate"><span class="pre">scrape_medicine_page()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-web_scraper.filter_retry">web_scraper.filter_retry module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.filter_retry.retry_download"><code class="docutils literal notranslate"><span class="pre">retry_download()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.filter_retry.retry_medicine"><code class="docutils literal notranslate"><span class="pre">retry_medicine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.filter_retry.run_filter"><code class="docutils literal notranslate"><span class="pre">run_filter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-web_scraper.save_webdata">web_scraper.save_webdata module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.save_webdata.save_webdata_and_urls"><code class="docutils literal notranslate"><span class="pre">save_webdata_and_urls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.save_webdata.set_active_refused_webdata"><code class="docutils literal notranslate"><span class="pre">set_active_refused_webdata()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-web_scraper.url_scraper">web_scraper.url_scraper module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.url_scraper.check_scrape_page"><code class="docutils literal notranslate"><span class="pre">check_scrape_page()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#web_scraper.url_scraper.get_annex_10_urls"><code class="docutils literal notranslate"><span class="pre">get_annex_10_urls()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Web Scraper</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">web_scraper</a> &raquo;</li>
        
      <li>web_scraper package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="module-web_scraper">
<span id="web-scraper-package"></span><h1>web_scraper package<a class="headerlink" href="#module-web_scraper" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-web_scraper.__main__">
<span id="web-scraper-main-module"></span><h2>web_scraper.__main__ module<a class="headerlink" href="#module-web_scraper.__main__" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.__main__.main">
<span class="sig-prename descclassname"><span class="pre">web_scraper.__main__.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">WebConfig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.__main__.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function that controls which scrapers are activated, and if it runs parallel or not.</p>
<p>Based on some variables declared at the top of the file, it will scrape the EC website, the EMA website
and/or downloads the scraped links.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>config_objects.WebConfig</em>) – Object that contains the variables that define the behaviour of webscraper</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-web_scraper.download">
<span id="web-scraper-download-module"></span><h2>web_scraper.download module<a class="headerlink" href="#module-web_scraper.download" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.download.download_all">
<span class="sig-prename descclassname"><span class="pre">web_scraper.download.</span></span><span class="sig-name descname"><span class="pre">download_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">urls_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel_download</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.download.download_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads all files for all medicines. Can be done parallel or sequential.
First it reads the CSV files, and then calls download_medicine_files function for all medicines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_filepath</strong> (<em>str</em>) – the path to the data folder</p></li>
<li><p><strong>urls_dict</strong> (<em>json_helper.JsonHelper</em>) – The dictionary containing the urls of all medicine files</p></li>
<li><p><strong>parallel_download</strong> (<em>bool</em>) – If this boolean is set to True, the files will be downloaded parallel</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.download.download_medicine_files">
<span class="sig-prename descclassname"><span class="pre">web_scraper.download.</span></span><span class="sig-name descname"><span class="pre">download_medicine_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">medicine_identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">urls_json</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.download.download_medicine_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads all the pdf files that belong to a medicine.
Logs successful downloads and also logs if not all files could be downloaded for a specific medicine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>medicine_identifier</strong> (<em>str</em>) – The EU number of the medicine where we want to download the files of</p></li>
<li><p><strong>url_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>str</em><em>]</em>) – the dictionary containing all the urls of a specific medicine</p></li>
<li><p><strong>urls_json</strong> (<em>json_helper.JsonHelper</em>) – The dictionary containing the urls of all medicine files</p></li>
<li><p><strong>data_path</strong> (<em>str</em>) – The path to the data folder</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.download.download_pdfs_ec">
<span class="sig-prename descclassname"><span class="pre">web_scraper.download.</span></span><span class="sig-name descname"><span class="pre">download_pdfs_ec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">medicine_identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_urls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">med_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">urls_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.download.download_pdfs_ec" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads the pdfs of the EC website files for a specific medicine and a specific file type (decision or annex)
It evaluates the string in the pdf_urls_dict to a list of urls which then can be used for downloading with the
download_pdf_from_url function.
The filename_elements used for structuring the filename are also specified in this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>medicine_identifier</strong> (<em>str</em>) – The EU number of the medicine where the files should be downloaded for.</p></li>
<li><p><strong>pdf_type</strong> (<em>str</em>) – The type of pdf: decision or annex</p></li>
<li><p><strong>pdf_urls</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – The list containing the urls to the pdf files.</p></li>
<li><p><strong>med_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>,</em><em>str</em><em>]</em>) – The dictionary containing the attributes of the medicine. Used for structuring the filename</p></li>
<li><p><strong>target_path</strong> (<em>str</em>) – The path to the data folder</p></li>
<li><p><strong>urls_dict</strong> (<em>json_helper.JsonHelper</em>) – the dictionary containing all the urls of a specific medicine</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – If true overwrites the current files in the medicine folder</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.download.download_pdfs_ema">
<span class="sig-prename descclassname"><span class="pre">web_scraper.download.</span></span><span class="sig-name descname"><span class="pre">download_pdfs_ema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eu_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">med_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.download.download_pdfs_ema" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads the pdfs of the EMA website files for a specific medicine.
It gets the url from the epar dictionary which is used for downloading with the download_pdf_from_url function.
The filename_elements used for structuring the filename are also specified in this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eu_num</strong> (<em>str</em>) – The EU number of the medicine where the files should be downloaded for.</p></li>
<li><p><strong>pdf_type</strong> (<em>str</em>) – The type of pdf. epar, omar or odwar</p></li>
<li><p><strong>pdf_url</strong> (<em>str</em>) – </p></li>
<li><p><strong>med_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>,</em><em>str</em><em>]</em>) – The dictionary containing the attributes of the medicine.
Used for structuring the filename</p></li>
<li><p><strong>target_path</strong> (<em>str</em>) – The path to the data folder</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – If true overwrites the current files in the medicine folder</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.download.get_date_from_url">
<span class="sig-prename descclassname"><span class="pre">web_scraper.download.</span></span><span class="sig-name descname"><span class="pre">get_date_from_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.download.get_date_from_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the date from a file (for filedates.json) based on an url. If no date in the url is found, the scrape date
is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>url</strong> (<em>str</em>) – the url where the date should be retrieved from</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the url, the date of the url and the datetime of the scrape</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict[str, str])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.download.save_new_eu_numbers">
<span class="sig-prename descclassname"><span class="pre">web_scraper.download.</span></span><span class="sig-name descname"><span class="pre">save_new_eu_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.download.save_new_eu_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes EU numbers of medicines that contain new files to f”{data_path}/eu_numbers.json”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_path</strong> (<em>str</em>) – The path to the data folder</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-web_scraper.ec_scraper">
<span id="web-scraper-ec-scraper-module"></span><h2>web_scraper.ec_scraper module<a class="headerlink" href="#module-web_scraper.ec_scraper" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.add_to_non_english_file">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">add_to_non_english_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eu_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decision_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">procedure_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.add_to_non_english_file" title="Permalink to this definition">¶</a></dt>
<dd><p>This function appends a line to the no_english_available.txt to make an overview of all files that don’t have an
english version.
:param eu_n: The short eu_n, used to form the url to the medicine page
:type eu_n: str
:param decision_date: The date of the decision.
:type decision_date: datetime.date
:param filetype: The type of the file (decision or annex)
:type filetype: str
:param procedure_type: The procedure type of the file (as stated on the ec website)
:type procedure_type: str
:param data: Path to the data folder
:type data: str</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.determine_current_aut_type">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">determine_current_aut_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last_decision_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.determine_current_aut_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the current authorization type for a medicine</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>last_decision_types</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – The decision types from the last year and a half</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The current decision type</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.determine_ema_number">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">determine_ema_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ema_numbers:</span> <span class="pre">list[str])</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.determine_ema_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the right EMA number from the list of procedures</p>
<p>The right EMA number is simply the EMA number that occurs most often in the procedures table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ema_numbers</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – The list of formatted EMA numbers in the JSON file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function returns the EMA number that occurs the most,
and a fraction how often this EMA number is present in the list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str, float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.determine_initial_aut_type">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">determine_initial_aut_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_exceptional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_conditional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.determine_initial_aut_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the initial authorization type, based on whether it has seen exceptional or conditional procedures</p>
<p>For procedures from before 2006, it is not possible to determine the initial authorization type.
Otherwise, the procedure type van be determined, which is either exceptional, conditional or standard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<em>int</em>) – The year of the first procedure.</p></li>
<li><p><strong>is_exceptional</strong> (<em>bool</em>) – “Annual Reassessment” is among the procedures</p></li>
<li><p><strong>is_conditional</strong> (<em>bool</em>) – “Annual renewal” is among the procedures</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial type of EU authorization.
Can be “pre_2006”, “exceptional_conditional”, “exceptional”, “conditional”, or “standard”.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.format_ema_number">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">format_ema_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ema_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.format_ema_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats the input into a (list of) EMA number(s)</p>
<p>In the procedures JSON file, there is often an EMA number present for a procedure, and sometimes multiple.
The EMA numbers are formatted with a RegEx, that handles both EMA numbers for human use and orphan medicine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ema_number</strong> (<em>str</em>) – EMA number value directly fetched from the JSON, corresponding to a procedure</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of formatted EMA numbers. Usually it only contains one EMA number, but sometimes multiple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.get_data_from_medicine_json">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">get_data_from_medicine_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">medicine_json</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eu_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MedicineType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.get_data_from_medicine_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all attribute information that is stored in the medicine JSON, and all links to the EMA website.</p>
<p>The function loops through the JSON object and finds all the attributes and links,
so that they can be used and stored. Whenever an attribute is not found, this is logged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>medicine_json</strong> (<em>dict</em>) – The JSON object that contains all relevant attributes and links.</p></li>
<li><p><strong>eu_num</strong> (<em>str</em>) – The EU number for the medicine that belongs to this JSON.</p></li>
<li><p><strong>medicine_type</strong> (<em>MedicineType</em>) – The type of medicine that belongs to this JSON.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>First item in the tuple is a dictionary with all the attribute values.
The second item in the tuple is a list with all the links to the EMA.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict[str, str], list[str])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.get_data_from_procedures_json">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">get_data_from_procedures_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">procedures_json</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eu_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.get_data_from_procedures_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all attribute information that is stored in the procedures JSON, and all links the decision and annex PDFs.</p>
<p>The function loops through the JSON object and finds all the attributes and links,
so that they can be used and stored. There is also some extra logic that is needed to determine some attribute
values. This is done for the EMA number (certainty), the initial authorization type and current authorization type.
Whenever an attribute is not found, this is logged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>procedures_json</strong> (<em>dict</em>) – The JSON object that contains all relevant attributes and links</p></li>
<li><p><strong>eu_num</strong> (<em>str</em>) – The EU number for the medicine that belongs to this JSON</p></li>
<li><p><strong>data_folder</strong> (<em>str</em>) – Path to the data folder</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a dictionary with all the attribute values, a list
with all the links decisions and a list with the links to the annexes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict[str, str], list[(str, int)], list[(str, int)])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.get_ec_html">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">get_ec_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Response</span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.get_ec_html" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the html from a website.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>url</strong> (<em>str</em>) – The link to the page where the html is needed from.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a Response object that contains the response to the HTTP request.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>requests.Response</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.get_ec_json_objects">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">get_ec_json_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">html_active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.get_ec_json_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all the JSON objects from a web page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>html_active</strong> (<em>requests.Response</em>) – The response to the HTTP request for the page where the JSONs need
to be fetched from.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All the JSONs on the web page are returned in a list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.get_last_updated_date">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">get_last_updated_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">html_active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">date</span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.get_last_updated_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the last updated date for a medicine on the EC website</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>html_active</strong> (<em>requests.Response</em>) – html object for the webpage. Contains a string with ‘Last updated on ‘##/##/####’</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The date in the aforementioned string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(datetime.date)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.scrape_active_withdrawn_jsons">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">scrape_active_withdrawn_jsons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.scrape_active_withdrawn_jsons" title="Permalink to this definition">¶</a></dt>
<dd><p>Scrape the EC website for active and withdrawn medicine JSONs.</p>
<p>The JSON files that are scraped are needed to construct the url to each individual medicine page.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The list of JSONs that for active and withdrawn, human use and orphan medicine.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.scrape_ec">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">scrape_ec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">WebConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_refused_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.scrape_ec" title="Permalink to this definition">¶</a></dt>
<dd><p>Scrapes all medicine URLs and medicine data from the EC website</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>config_objects.WebConfig</em>) – Object that contains the variables that define the behaviour of webscraper</p></li>
<li><p><strong>medicine_list</strong> (<em>list</em><em>[</em><em>(</em><em>str</em><em>, </em><em>str</em><em>, </em><em>int</em><em>, </em><em>str</em><em>)</em><em>]</em>) – A list of medicines, structured as
<a href="#id1"><span class="problematic" id="id2">`</span></a>{url, eu_num_full, medicine_type, eu_num_short}</p></li>
<li><p><strong>url_file</strong> (<em>json_helper.JsonHelper</em>) – the dictionary containing all the urls of a specific medicine</p></li>
<li><p><strong>url_refused_file</strong> (<em>json_helper.JsonHelper</em>) – The dictionary containing the urls of all refused files</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.scrape_medicine_page">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">scrape_medicine_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eu_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">html_active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MedicineType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.scrape_medicine_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Scrapes a medicine page for all pdf urls, urls to the ema website and attributes for a single medicine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eu_num</strong> (<em>str</em>) – Number that identifies the medicine</p></li>
<li><p><strong>html_active</strong> (<em>requests.Response</em>) – html object that contains all html text</p></li>
<li><p><strong>medicine_type</strong> (<em>MedicineType</em>) – The type of medicine this medicine is.</p></li>
<li><p><strong>data_folder</strong> (<em>str</em>) – Path to the data folder</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All the links to PDFs for decisions and annexes are
stored in lists and returned. The same is done for all links to the ema website. All attributes are
stored in a dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(list[(str, int)], list[(str, int)], list[str], dict[str, str])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.scrape_medicines_list">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">scrape_medicines_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.scrape_medicines_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Scrape the EC website, and construct urls to all individual medicine pages.</p>
<p>From the EC website, the JSON files for active and withdrawn medicine are scraped. The JSONs
contain information about the medicine that is needed to construct a link to each individual medicine page.
It does so for all active and withdrawn, orphan and human use medicine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The links to the medicine pages are stored in a list, along with the full EU number,
the medicine type and a short EU number.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[(str, str, int, str)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.scrape_refused_jsons">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">scrape_refused_jsons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.ec_scraper.scrape_refused_jsons" title="Permalink to this definition">¶</a></dt>
<dd><p>Scrape the EC website for refused medicine JSONs.</p>
<p>The JSON files that are scraped are needed to construct the url to each individual medicine page.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The list of JSONs that for refused, human use and orphan medicine.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.set_human_attributes">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">set_human_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ema_url_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.set_human_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates medicine_dict with attributes from the EC website for human use medicines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ema_url_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of URLs to EMA websites</p></li>
<li><p><strong>medicine_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – A dictionary containing all the attribute values and a list
with all the links to the EMA.</p></li>
<li><p><strong>row</strong> (<em>dict</em>) – Row in medicine_json to be searched</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ec_scraper.set_orphan_attributes">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ec_scraper.</span></span><span class="sig-name descname"><span class="pre">set_orphan_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ema_url_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ec_scraper.set_orphan_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates medicine_dict with attributes from the EC website for orphan medicines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ema_url_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of URLs to EMA websites</p></li>
<li><p><strong>medicine_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – A dictionary containing all the attribute values and a list
with all the links to the EMA.</p></li>
<li><p><strong>row</strong> (<em>dict</em>) – Row in medicine_json to be searched</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-web_scraper.ema_scraper">
<span id="web-scraper-ema-scraper-module"></span><h2>web_scraper.ema_scraper module<a class="headerlink" href="#module-web_scraper.ema_scraper" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ema_scraper.create_url_list">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ema_scraper.</span></span><span class="sig-name descname"><span class="pre">create_url_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">complete_soup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BeautifulSoup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.ema_scraper.create_url_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a list of urls of medicines in a specific section</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>complete_soup</strong> (<em>bs4.BeautifulSoup</em>) – Section of HTML site</p></li>
<li><p><strong>medicine_name</strong> (<em>str</em>) – Name of medicine, obtained from URL</p></li>
<li><p><strong>message</strong> (<em>str</em>) – Message to be printed when no URLs are found</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>url_list of the urls found in the website section</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ema_scraper.find_last_updated_date">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ema_scraper.</span></span><span class="sig-name descname"><span class="pre">find_last_updated_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">html_active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">date</span></span></span><a class="headerlink" href="#web_scraper.ema_scraper.find_last_updated_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the date when a medicine page was last updated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>html_active</strong> (<em>requests.Response</em>) – html object that contains raw html for a webpage for a medicine on the EMA website</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>When the medicine page on the EMA website was last updated</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.date</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ema_scraper.find_last_updated_date_annex10">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ema_scraper.</span></span><span class="sig-name descname"><span class="pre">find_last_updated_date_annex10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">date</span></span></span><a class="headerlink" href="#web_scraper.ema_scraper.find_last_updated_date_annex10" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a piece of text with information when an excel-sheet was last updated to a datetime object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – text containing information when it was last updated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>When the excel-sheet was last updated</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime.date</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ema_scraper.find_priority_link">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ema_scraper.</span></span><span class="sig-name descname"><span class="pre">find_priority_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#web_scraper.ema_scraper.find_priority_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the url with the highest priority in a list of urls</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>priority_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – String that the url must contain. Strings with a lower index have higher priority</p></li>
<li><p><strong>url_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of urls to be searched</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the highest priority url, or if it can’t find it, an empty string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ema_scraper.get_url_type">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ema_scraper.</span></span><span class="sig-name descname"><span class="pre">get_url_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epar_priority_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odwar_priority_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omar_priority_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#web_scraper.ema_scraper.get_url_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the file type of a given URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epar_priority_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – list of strings that could be in a EPAR url</p></li>
<li><p><strong>odwar_priority_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – list of strings that could be in a ODWAR url</p></li>
<li><p><strong>omar_priority_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – list of strings that could be in a OMAR url</p></li>
<li><p><strong>url</strong> (<em>str</em>) – url used to determine file type</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>type of the url</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ema_scraper.scrape_ema">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ema_scraper.</span></span><span class="sig-name descname"><span class="pre">scrape_ema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">WebConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.ema_scraper.scrape_ema" title="Permalink to this definition">¶</a></dt>
<dd><p>Scrapes all medicine URLs and medicine data from the EMA website</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>config_objects.WebConfig</em>) – Object that contains the variables that define the behaviour of webscraper</p></li>
<li><p><strong>url_file</strong> (<em>json_helper.JsonHelper</em>) – the dictionary containing all the urls of a specific medicine</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.ema_scraper.scrape_medicine_page">
<span class="sig-prename descclassname"><span class="pre">web_scraper.ema_scraper.</span></span><span class="sig-name descname"><span class="pre">scrape_medicine_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">html_active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Response</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#web_scraper.ema_scraper.scrape_medicine_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an url to an EMA medicine page, the method will return an EPAR, OMAR, and ODWAR in case they exist.
All other market authorisation documents will also be returned as a list. The special files mentioned above
are excluded from this list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – Link to the medicine page on the EMA website</p></li>
<li><p><strong>html_active</strong> (<em>requests.Response</em>) – html object that contains html of the EMA page for a medicine</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If nothing is found, we throw an exception. This also passes all found URLs on newlines</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of links to PDF files of interest from the EMA website.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str | list[str]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-web_scraper.filter_retry">
<span id="web-scraper-filter-retry-module"></span><h2>web_scraper.filter_retry module<a class="headerlink" href="#module-web_scraper.filter_retry" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.filter_retry.retry_download">
<span class="sig-prename descclassname"><span class="pre">web_scraper.filter_retry.</span></span><span class="sig-name descname"><span class="pre">retry_download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eu_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.filter_retry.retry_download" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the download function for a specific file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eu_n</strong> (<em>str</em>) – eu number used for calling the download function</p></li>
<li><p><strong>filename_elements</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – filename elements, used as parameter in the download function</p></li>
<li><p><strong>url_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>] </em><em>| </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – dictionary that contains the url where to download from</p></li>
<li><p><strong>data_filepath</strong> (<em>str</em>) – the path to the data folder</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.filter_retry.retry_medicine">
<span class="sig-prename descclassname"><span class="pre">web_scraper.filter_retry.</span></span><span class="sig-name descname"><span class="pre">retry_medicine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_refused_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.filter_retry.retry_medicine" title="Permalink to this definition">¶</a></dt>
<dd><p>For every line in filter.txt, it scrapes the urls again.
It also calls the download function for the specific file again</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter_line</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – line in filter.txt containing the EU number of medicine to download again</p></li>
<li><p><strong>url_file</strong> (<em>json_helper.JsonHelper</em>) – the dictionary with all the urls</p></li>
<li><p><strong>data_filepath</strong> (<em>str</em>) – the path to the data folder</p></li>
<li><p><strong>url_refused_file</strong> (<em>json_helper.JsonHelper</em>) – dictionary with all refused urls</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.filter_retry.run_filter">
<span class="sig-prename descclassname"><span class="pre">web_scraper.filter_retry.</span></span><span class="sig-name descname"><span class="pre">run_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.filter_retry.run_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>calls filter and runs retry function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of times filter is called</p></li>
<li><p><strong>data_filepath</strong> (<em>str</em>) – the path to the data folder.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-web_scraper.save_webdata">
<span id="web-scraper-save-webdata-module"></span><h2>web_scraper.save_webdata module<a class="headerlink" href="#module-web_scraper.save_webdata" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.save_webdata.save_webdata_and_urls">
<span class="sig-prename descclassname"><span class="pre">web_scraper.save_webdata.</span></span><span class="sig-name descname"><span class="pre">save_webdata_and_urls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">medicine_identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anx_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ema_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.save_webdata.save_webdata_and_urls" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a webdata JSON file in the correct location, containing scraped attributes from the EC website.
It also adds urls to the right url JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>medicine_identifier</strong> (<em>str</em>) – Identifier for a medicine. An EU number for non-refused medicine, EMA number for
refused medicine</p></li>
<li><p><strong>medicine_url</strong> (<em>str</em>) – url to a medicine page for a specific medicine.</p></li>
<li><p><strong>dec_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of urls to decisions on the EC website.</p></li>
<li><p><strong>anx_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of urls to annexes on the EC website.</p></li>
<li><p><strong>ema_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of urls to EMA pages on the EC website.</p></li>
<li><p><strong>attributes_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – Dictionary of scraped attributes on the EC website</p></li>
<li><p><strong>url_file</strong> (<em>JsonHelper</em>) – The url json where all the data needs to be stored.</p></li>
<li><p><strong>target_path</strong> (<em>str</em>) – Directory where the json needs to be stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.save_webdata.set_active_refused_webdata">
<span class="sig-prename descclassname"><span class="pre">web_scraper.save_webdata.</span></span><span class="sig-name descname"><span class="pre">set_active_refused_webdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eu_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anx_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ema_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_refused_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.save_webdata.set_active_refused_webdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on whether the medicine is refused or not, it will set the parameters, so that it can be saved to the file
system correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eu_n</strong> (<em>str</em>) – EU number of the medicine.</p></li>
<li><p><strong>medicine_url</strong> (<em>str</em>) – url to a medicine page for a specific medicine.</p></li>
<li><p><strong>dec_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of urls to decisions on the EC website.</p></li>
<li><p><strong>anx_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of urls to annexes on the EC website.</p></li>
<li><p><strong>ema_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of urls to EMA pages on the EC website.</p></li>
<li><p><strong>attributes_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – Dictionary of scraped attributes on the EC website</p></li>
<li><p><strong>data_path</strong> (<em>str</em>) – The path where the JSON files need to be stored.</p></li>
<li><p><strong>url_file</strong> (<em>JsonHelper</em>) – the dictionary containing all the urls of a specific medicine</p></li>
<li><p><strong>url_refused_file</strong> (<em>JsonHelper</em>) – The dictionary containing the urls of all refused files</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-web_scraper.url_scraper">
<span id="web-scraper-url-scraper-module"></span><h2>web_scraper.url_scraper module<a class="headerlink" href="#module-web_scraper.url_scraper" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.url_scraper.check_scrape_page">
<span class="sig-prename descclassname"><span class="pre">web_scraper.url_scraper.</span></span><span class="sig-name descname"><span class="pre">check_scrape_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eu_n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medicine_last_updated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_scraped_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#web_scraper.url_scraper.check_scrape_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the medicine page (either EC or EMA) has been updated since last scrape cycle, or that the page has
never been scraped at all. Based on this it returns a boolean that indicates whether attributes and files need to be
fetched from the html</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eu_n</strong> (<em>str</em>) – EU number of the medicine</p></li>
<li><p><strong>medicine_last_updated</strong> (<em>datetime.date</em>) – Date since the page was last updated</p></li>
<li><p><strong>last_scraped_type</strong> (<em>str</em>) – The page type (either EC or EMA)</p></li>
<li><p><strong>url_file</strong> (<em>json_helper.JsonHelper</em>) – the dictionary containing all the urls of a specific medicine</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>False indicates that the website has not been updated since the last scrape cycle</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="web_scraper.url_scraper.get_annex_10_urls">
<span class="sig-prename descclassname"><span class="pre">web_scraper.url_scraper.</span></span><span class="sig-name descname"><span class="pre">get_annex_10_urls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annex_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JsonHelper</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#web_scraper.url_scraper.get_annex_10_urls" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all annex10 files from the EMA website</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – link to where all annex10 files are stored</p></li>
<li><p><strong>annex_dict</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Dictionary that contains links to the annex files per year
and when they were last updated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modules.html" class="btn btn-neutral float-left" title="web_scraper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Medisee.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>